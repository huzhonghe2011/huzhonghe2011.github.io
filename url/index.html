<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>嵌入页面</title>
    <style>
        /* 去掉 body 和 html 元素的默认边距和内边距 */
        html, body {
            margin: 0;
            padding: 0;
            height: 100%; /* 保证页面高度为 100% */
        }

        /* iframe 全屏显示，去掉边框、间距 */
        iframe {
            width: 100%;
            height: 100%;
            border: none; /* 去掉边框 */
            margin: 0;    /* 去掉外边距 */
            padding: 0;   /* 去掉内边距 */
            display: block; /* 去掉默认的 inline-block 属性 */
        }

        /* 输入框和按钮的样式 */
        .input-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
            font-size: 18px;
        }

        .input-container input {
            width: 300px;
            padding: 10px;
            font-size: 16px;
            margin-right: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        .input-container button {
            padding: 10px 20px;
            font-size: 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .input-container button:hover {
            background-color: #45a049;
        }

        .message {
            text-align: center;
            font-size: 20px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div id="container">
        <div id="message" class="message">请输入链接：</div>
        <div class="input-container">
            <input type="text" id="url-input" placeholder="https://" value="https://">
            <button id="submit-button">确认</button>
        </div>
        <iframe id="iframe" style="display:none;"></iframe>
    </div>

    <script>
        // 获取 URL 参数
        const urlParams = new URLSearchParams(window.location.search);
        const url = urlParams.get('url'); // 获取名为 "url" 的参数

        // 判断是否包含 "https://huzhonghe2011.github.io/"，防止循环嵌套
        function isEmbeddedUrl(url) {
            return url && url.startsWith('https://huzhonghe2011.github.io/');
        }

        // 判断 URL 是否有效，且不为循环嵌入的 URL
        function isValidUrl(input) {
            return (input && (input.startsWith('http://') || input.startsWith('https://'))) && !isEmbeddedUrl(input);
        }

        // 判断 URL 参数是否有效
        if (url) {
            // 如果有 URL 参数，检查并加载该 URL
            const iframe = document.getElementById('iframe');
            const message = document.getElementById('message');

            // 去除 URL 的前后空格
            const trimmedUrl = url.trim();

            // 如果 URL 是有效的（以 https:// 或 http:// 开头），且不为嵌入的页面，显示 iframe 并嵌入链接
            if (isValidUrl(trimmedUrl)) {
                iframe.style.display = 'block';
                iframe.src = trimmedUrl; // 设置 iframe 的 src 属性为目标 URL
                message.style.display = 'none'; // 隐藏提示信息
            } else {
                // 如果 URL 无效或为嵌入链接，显示提示
                message.textContent = '提供的 URL 无效或为嵌入页面，无法加载。';
            }
        } else {
            // 如果没有 URL 参数，显示输入框
            const inputContainer = document.querySelector('.input-container');
            inputContainer.style.display = 'flex';

            // 处理按钮点击事件
            document.getElementById('submit-button').addEventListener('click', function() {
                const input = document.getElementById('url-input').value.trim();

                // 检查输入的链接是否有效且不为嵌入页面
                if (isValidUrl(input)) {
                    // 构造跳转的 URL，并跳转
                    window.location.href = `https://huzhonghe2011.github.io/url?url=${encodeURIComponent(input)}`;
                } else {
                    alert('请输入有效的链接，确保以 http:// 或 https:// 开头，且不能是https://huzhonghe2011.github.io开头。');
                }
            });
        }
    </script>
</body>
</html>
